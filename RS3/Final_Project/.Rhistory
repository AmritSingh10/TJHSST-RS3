glance(step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Stepwise Model") %>%
kable_styling(full_width = FALSE)
glance(log_step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Log Stepwise Model") %>%
kable_styling(full_width = FALSE)
tidy(step_model, conf.int = TRUE) %>%
kable(digits = 4, caption = "Final Stepwise Model (Enrollment Totals)") %>%
kable_styling(full_width = FALSE)
tidy(log_step_model, conf.int = TRUE) %>%
kable(
digits = 4,
caption = "Log-Transformed Stepwise Model (Enrollment Totals)"
) %>%
kable_styling(full_width = FALSE)
ggplot(df2, aes(x = year, y = resid(step_model))) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0, color = "red") +
labs(
title = "Residuals vs Year (Independence Check)",
x = "Year",
y = "Residuals"
)
summary(step_model)$fstatistic
anova(step_model)
# 95% Confidence Intervals
tidy(step_model, conf.int = TRUE, conf.level = 0.95) %>%
dplyr::select(term, estimate, conf.low, conf.high) %>%
kable(
digits = 4,
caption = "95% Confidence Intervals for Regression Coefficients"
) %>%
kable_styling(full_width = FALSE)
glimpse(df2)
summary(df2)
library(tidyverse)
library(caret)
library(leaps)
library(car)
library(corrplot)
library(broom)
library(knitr)
library(kableExtra)
library(lmtest)
library(sandwich)
library(MASS)
df <- read_csv("dataset.csv")
df2 <- df %>%
rename(
county_id        = `County ID`,
county           = County,
year             = Year,
enrolled_total   = `Admissions Enrolled Total`,
admitted_total   = `Admissions Total`,
applicants_total = `Applicants Total`,
admit_rate       = `Applicant Admitted`,
yield_rate       = `Admitted who Enrolled`
) %>%
drop_na(enrolled_total, admitted_total, applicants_total, admit_rate, yield_rate, year) %>%
mutate(county = factor(county))
glimpse(df2)
summary(df2)
df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate) %>%
pivot_longer(everything(), names_to = "variable", values_to = "value") %>%
ggplot(aes(x = value)) +
geom_histogram(bins = 30) +
facet_wrap(~variable, scales = "free") +
labs(
title = "Distributions of Admissions Pipeline Variables",
x = "Value",
y = "Count"
)
corr_vars <- df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate, year)
corr_matrix <- cor(corr_vars, use = "complete.obs")
corrplot(
corr_matrix,
method = "color",
type = "lower",
tl.cex = 0.8,
title = "Correlation Matrix of Key Variables",
mar = c(0, 0, 2, 0)
)
full_model <- lm(
enrolled_total ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(full_model)
vif(full_model)
step_model <- stepAIC(
full_model,
direction = "both",
trace = TRUE
)
summary(step_model)
vif(step_model)
plot(
fitted(step_model),
resid(step_model),
main = "Residuals vs Fitted (Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(step_model),
breaks = 30,
main = "Histogram of Residuals (Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(step_model),
main = "Normal Q-Q Plot (Stepwise Model)"
)
qqline(resid(step_model), col = "red")
bptest(step_model)
coeftest(step_model, vcov = vcovHC(step_model, type = "HC1"))
df2 <- df2 %>%
mutate(log_enrolled = log(enrolled_total + 1))
log_full_model <- lm(
log_enrolled ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(log_full_model)
vif(log_full_model)
log_step_model <- stepAIC(
log_full_model,
direction = "both",
trace = TRUE
)
summary(log_step_model)
vif(log_step_model)
plot(
fitted(log_step_model),
resid(log_step_model),
main = "Residuals vs Fitted (Log Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(log_step_model),
breaks = 30,
main = "Histogram of Residuals (Log Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(log_step_model),
main = "Normal Q-Q Plot (Log Stepwise Model)"
)
qqline(resid(log_step_model), col = "red")
glance(step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Stepwise Model") %>%
kable_styling(full_width = FALSE)
glance(log_step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Log Stepwise Model") %>%
kable_styling(full_width = FALSE)
tidy(step_model, conf.int = TRUE) %>%
kable(digits = 4, caption = "Final Stepwise Model (Enrollment Totals)") %>%
kable_styling(full_width = FALSE)
tidy(log_step_model, conf.int = TRUE) %>%
kable(
digits = 4,
caption = "Log-Transformed Stepwise Model (Enrollment Totals)"
) %>%
kable_styling(full_width = FALSE)
ggplot(df2, aes(x = year, y = resid(step_model))) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0, color = "red") +
labs(
title = "Residuals vs Year (Independence Check)",
x = "Year",
y = "Residuals"
)
summary(step_model)$fstatistic
anova(step_model)
# 95% Confidence Intervals
tidy(step_model, conf.int = TRUE, conf.level = 0.95) %>%
dplyr::select(term, estimate, conf.low, conf.high) %>%
kable(
digits = 4,
caption = "95% Confidence Intervals for Regression Coefficients"
) %>%
kable_styling(full_width = FALSE)
glance(step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Stepwise Model")
glance(log_step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Log Stepwise Model")
library(tidyverse)
library(caret)
library(leaps)
library(car)
library(corrplot)
library(broom)
library(knitr)
library(kableExtra)
library(lmtest)
library(sandwich)
library(MASS)
df <- read_csv("dataset.csv")
df2 <- df %>%
rename(
county_id        = `County ID`,
county           = County,
year             = Year,
enrolled_total   = `Admissions Enrolled Total`,
admitted_total   = `Admissions Total`,
applicants_total = `Applicants Total`,
admit_rate       = `Applicant Admitted`,
yield_rate       = `Admitted who Enrolled`
) %>%
drop_na(enrolled_total, admitted_total, applicants_total, admit_rate, yield_rate, year) %>%
mutate(county = factor(county))
glimpse(df2)
summary(df2)
df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate) %>%
pivot_longer(everything(), names_to = "variable", values_to = "value") %>%
ggplot(aes(x = value)) +
geom_histogram(bins = 30) +
facet_wrap(~variable, scales = "free") +
labs(
title = "Distributions of Admissions Pipeline Variables",
x = "Value",
y = "Count"
)
corr_vars <- df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate, year)
corr_matrix <- cor(corr_vars, use = "complete.obs")
corrplot(
corr_matrix,
method = "color",
type = "lower",
tl.cex = 0.8,
title = "Correlation Matrix of Key Variables",
mar = c(0, 0, 2, 0)
)
full_model <- lm(
enrolled_total ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(full_model)
vif(full_model)
step_model <- stepAIC(
full_model,
direction = "both",
trace = TRUE
)
summary(step_model)
vif(step_model)
plot(
fitted(step_model),
resid(step_model),
main = "Residuals vs Fitted (Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(step_model),
breaks = 30,
main = "Histogram of Residuals (Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(step_model),
main = "Normal Q-Q Plot (Stepwise Model)"
)
qqline(resid(step_model), col = "red")
bptest(step_model)
coeftest(step_model, vcov = vcovHC(step_model, type = "HC1"))
df2 <- df2 %>%
mutate(log_enrolled = log(enrolled_total + 1))
log_full_model <- lm(
log_enrolled ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(log_full_model)
vif(log_full_model)
log_step_model <- stepAIC(
log_full_model,
direction = "both",
trace = TRUE
)
summary(log_step_model)
vif(log_step_model)
plot(
fitted(log_step_model),
resid(log_step_model),
main = "Residuals vs Fitted (Log Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(log_step_model),
breaks = 30,
main = "Histogram of Residuals (Log Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(log_step_model),
main = "Normal Q-Q Plot (Log Stepwise Model)"
)
qqline(resid(log_step_model), col = "red")
glance(step_model) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Model Fit Summary: Stepwise Model"
)
glance(log_step_model) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Model Fit Summary: Log Stepwise Model"
)
tidy(step_model, conf.int = TRUE) %>%
kable(digits = 4, caption = "Final Stepwise Model (Enrollment Totals)") %>%
kable_styling(full_width = FALSE)
tidy(log_step_model, conf.int = TRUE) %>%
kable(
digits = 4,
caption = "Log-Transformed Stepwise Model (Enrollment Totals)"
) %>%
kable_styling(full_width = FALSE)
ggplot(df2, aes(x = year, y = resid(step_model))) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0, color = "red") +
labs(
title = "Residuals vs Year (Independence Check)",
x = "Year",
y = "Residuals"
)
summary(step_model)$fstatistic
anova(step_model)
# 95% Confidence Intervals
tidy(step_model, conf.int = TRUE, conf.level = 0.95) %>%
dplyr::select(term, estimate, conf.low, conf.high) %>%
kable(
digits = 4,
caption = "95% Confidence Intervals for Regression Coefficients"
) %>%
kable_styling(full_width = FALSE)
glance(step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Stepwise Model")
glance(log_step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Log Stepwise Model")
library(tidyverse)
library(caret)
library(leaps)
library(car)
library(corrplot)
library(broom)
library(knitr)
library(kableExtra)
library(lmtest)
library(sandwich)
library(MASS)
df <- read_csv("dataset.csv")
df2 <- df %>%
rename(
county_id        = `County ID`,
county           = County,
year             = Year,
enrolled_total   = `Admissions Enrolled Total`,
admitted_total   = `Admissions Total`,
applicants_total = `Applicants Total`,
admit_rate       = `Applicant Admitted`,
yield_rate       = `Admitted who Enrolled`
) %>%
drop_na(enrolled_total, admitted_total, applicants_total, admit_rate, yield_rate, year) %>%
mutate(county = factor(county))
glimpse(df2)
summary(df2)
df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate) %>%
pivot_longer(everything(), names_to = "variable", values_to = "value") %>%
ggplot(aes(x = value)) +
geom_histogram(bins = 30) +
facet_wrap(~variable, scales = "free") +
labs(
title = "Distributions of Admissions Pipeline Variables",
x = "Value",
y = "Count"
)
corr_vars <- df2 %>%
dplyr::select(enrolled_total, applicants_total, admitted_total, admit_rate, yield_rate, year)
corr_matrix <- cor(corr_vars, use = "complete.obs")
corrplot(
corr_matrix,
method = "color",
type = "lower",
tl.cex = 0.8,
title = "Correlation Matrix of Key Variables",
mar = c(0, 0, 2, 0)
)
full_model <- lm(
enrolled_total ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(full_model)
vif(full_model)
step_model <- stepAIC(
full_model,
direction = "both",
trace = TRUE
)
summary(step_model)
vif(step_model)
plot(
fitted(step_model),
resid(step_model),
main = "Residuals vs Fitted (Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(step_model),
breaks = 30,
main = "Histogram of Residuals (Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(step_model),
main = "Normal Q-Q Plot (Stepwise Model)"
)
qqline(resid(step_model), col = "red")
bptest(step_model)
coeftest(step_model, vcov = vcovHC(step_model, type = "HC1"))
df2 <- df2 %>%
mutate(log_enrolled = log(enrolled_total + 1))
log_full_model <- lm(
log_enrolled ~ applicants_total + admitted_total + admit_rate + yield_rate + year + county,
data = df2
)
summary(log_full_model)
vif(log_full_model)
log_step_model <- stepAIC(
log_full_model,
direction = "both",
trace = TRUE
)
summary(log_step_model)
vif(log_step_model)
plot(
fitted(log_step_model),
resid(log_step_model),
main = "Residuals vs Fitted (Log Stepwise Model)",
xlab = "Fitted Values",
ylab = "Residuals"
)
abline(h = 0, col = "red")
hist(
resid(log_step_model),
breaks = 30,
main = "Histogram of Residuals (Log Stepwise Model)",
xlab = "Residuals"
)
qqnorm(
resid(log_step_model),
main = "Normal Q-Q Plot (Log Stepwise Model)"
)
qqline(resid(log_step_model), col = "red")
glance(step_model) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Model Fit Summary: Stepwise Model"
)
glance(log_step_model) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Model Fit Summary: Log Stepwise Model"
)
tidy(step_model, conf.int = TRUE) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Final Stepwise Model (Enrollment Totals)"
)
tidy(log_step_model, conf.int = TRUE) %>%
kable(
digits = 4,
format = "pandoc",
caption = "Log-Transformed Stepwise Model (Enrollment Totals)"
)
ggplot(df2, aes(x = year, y = resid(step_model))) +
geom_point(alpha = 0.5) +
geom_hline(yintercept = 0, color = "red") +
labs(
title = "Residuals vs Year (Independence Check)",
x = "Year",
y = "Residuals"
)
summary(step_model)$fstatistic
anova(step_model)
# 95% Confidence Intervals
tidy(step_model, conf.int = TRUE, conf.level = 0.95) %>%
dplyr::select(term, estimate, conf.low, conf.high) %>%
kable(
digits = 4,
caption = "95% Confidence Intervals for Regression Coefficients"
) %>%
kable_styling(full_width = FALSE)
glance(step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Stepwise Model")
glance(log_step_model) %>%
kable(digits = 4, caption = "Model Fit Summary: Log Stepwise Model")
