---
title: "Day13"
author: "Amrit Singh"
date: "2025-10-28"
output:
  word_document: default
  html_document: default
---

```{r}
library(mosaic)
library(ggplot2)
library(dplyr)
library(Stat2Data)
library(readr)
library(HH)
library(leaps)
library(car)
library(MASS)


HighPeaks <- read_csv("HighPeaks.csv")
head(HighPeaks)
SATGPA <- read_csv("SATGPA.csv")
head(SATGPA)

#20
# a. I am about 90% confident that the true mean hiking speed lies between approximately 0.914 mph and 1.24 mph.
# b. Values are displayed within the provided code output.
# c. The simulated mean is 1.093031 with a standard deviation of 0.1205294, which is fairly similar to the original model’s standard deviation of 0.09699. These results are based on a sample of 5000 observations.
# d. Using the standard error calculation, the interval 1.077 +- 1.645 × 0.1205294 gives a confidence range of (0.8787, 1.2752).
# e. The quantile method provides an estimated interval of (0.9189363, 1.3059529).

# f. For the percentile comparison:
# Upper difference → 1.306 – 1.077 = 0.229
# Lower difference → 1.077 – 0.919 = 0.158
# Reflecting these distances around the mean results in an adjusted interval of (0.848, 1.235).

# g. Summary of intervals:
# t-distribution: (0.914, 1.24)
# Standard error method: (0.8787, 1.2752)
# Quantiles: (0.9189363, 1.3059529)
# Percentile differences: (0.158, 0.229)
# Reflected percentile interval: (0.848, 1.235)
# Overall, the intervals are quite consistent with each other, though the t-distribution interval is slightly narrower than the others.

#21
# Method 1: Using the formula 1.818 +- 1.645 × 0.1734197, I got a 90% confidence interval of (1.5327, 2.1033). This suggests that the true standard error is likely within that range.
# Method 2: The second approach produced a slightly different interval of (1.478401, 2.043009).
# Method 3: For the percentile-based method, I compared how far each bound was from the mean:
# Upper distance --> 2.043009−1.818=0.225
# Lower distance --> 1.818−1.478401=0.340
# Reflecting those values symmetrically around the mean gives an approximate interval of (1.478, 2.043). So based on this method, the actual slope is expected to fall within that range.

#23
# Parts (a) and (b) were completed within the R code, so I focused on summarizing the remaining methods.
# Method 1: Using the standard error technique, I rounded the standard deviation to 0.181 and the mean correlation to 0.2662. With a 95% confidence level (z∗ = 1.96) the interval 0.2662±1.96×0.181 gives (-0.08856, 0.62096). This suggests that the true correlation between GPA and Verbal SAT likely lies somewhere within that range.
# Method 2: The percentile method produced a similar interval: (-0.09149876, 0.61056238).
# Method 3: Using the reflected percentile approach with r = 0.3154 , I calculated how far each bound was from the mean:
# Upper distance: 0.61056238−0.3154=0.29516238
# Lower distance: 0.3154−(−0.09149876)=0.40689876
# Reversing these distances around the mean gave an estimated interval of (0.02023762, 0.72229876).
# Summary: All three methods yield ranges that cluster around approximately -0.10 to 0.60 (or slightly above). The third method shifts the interval a bit more toward positive values. However, since zero is included in every interval, there is not strong evidence of a definite relationship between GPA and Verbal SAT scores. The true correlation could be positive, negative, or even nonexistent.

#20
modfit <- lm(HighPeaks$Length~HighPeaks$Time)
summary(modfit)
confint(modfit,level=0.9)
set.seed(123)
i=5000
model <- do(i)*lm(Length~Time,data=resample(HighPeaks))
print(model)
hist(model$Time, xlab="Slope", ylab="Frequency", main = "Graph", col = "cyan", border = "black", lwd = 2)
summary(model$Time)
mean(model$Time)
sd(model$Time)
modlow <- quantile(model$Time,0.05)
modhigh<-quantile(model$Time,0.95)
c(modlow,modhigh)

#21
modfinal <- lm(HighPeaks$Length~HighPeaks$Time)
summary(modfinal)
set.seed(123)
i=5000
mod<-do(i)*sigma(lm(Length~Time,data=resample(HighPeaks)))
hist(mod$sigma, xlab="Sigma", ylab="Frequency", main = "Graph", col = "pink", border = "magenta", lwd = 2)
summary(mod$sigma)
mean(mod$sigma)
sd(mod$sigma)
modlow1 <- quantile(mod$sigma,0.05)
modhigh1<-quantile(mod$sigma,0.95)
c(modlow1,modhigh1)

#23
set.seed(123)
i=5000
mod3<-do(i)*cor(GPA~VerbalSAT,data=resample(SATGPA))
hist(mod3$cor, xlab="Correlation", ylab="Frequency", main = "Graph", col = "yellow", border = "orange", lwd = 2)
qqnorm(mod3$cor)
statmod <- lm(SATGPA$GPA~SATGPA$VerbalSAT)
summary(statmod)
summary(mod3$cor)
mean(mod3$cor)
sd(mod3$cor)
qqzmodel=qnorm(0.975) 
print(qqzmodel)
mlow <- quantile(mod3$cor,0.025)
mhigh<-quantile(mod3$cor,0.975)
c(mlow,mhigh)
```