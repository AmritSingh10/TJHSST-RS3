"0","library(readr)"
"0","library(MASS)"
"0",""
"0","CountyHealth <- read_csv(""CountyHealth.csv"")"
"0","CountyHealth$TsqrtMDs <- sqrt(CountyHealth$MDs)"
"0","FirstYearGPA <- read_csv(""FirstYearGPA.csv"")"
"0","HighPeaks <- read_csv(""HighPeaks.csv"")"
"0","ReligionGDP <- read_csv(""ReligionGDP.csv"")"
"0",""
"0","#8"
"0","#a)"
"0","train_CH <- CountyHealth[1:35, ]"
"0","model_CH <- lm(TsqrtMDs ~ Hospitals, data = train_CH)"
"0","summary(model_CH)"
"1","
Call:
"
"1",""
"1","lm(formula = TsqrtMDs ~ Hospitals, data = train_CH)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","    Min "
"1","     1Q "
"1"," Median "
"1","     3Q "
"1","    Max "
"1","
"
"1","-18.582 "
"1"," -6.362 "
"1"," -2.918 "
"1","  8.277 "
"1"," 23.170 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1","  -3.1695"
"1","     2.6915"
"1","  -1.178"
"1","    0.247"
"1","    "
"1","
Hospitals  "
"1","   6.7853"
"1","     0.5284"
"1","  12.841"
"1"," 2.19e-14"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","9.627"
"1"," "
"1","on"
"1"," "
"1","33"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.8332"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.8282"
"1"," "
"1","
F-statistic:"
"1"," "
"1","164.9"
"1"," "
"1","on"
"1"," "
"1","1"
"1"," "
"1","and"
"1"," "
"1","33"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","2.194e-14"
"1","
"
"1","
"
"0","# LSRL is sqrtMDs = -3.1695 + 6.7853Hospitals"
"0",""
"0","#b)"
"0","test_CH <- CountyHealth[36:nrow(CountyHealth), ]"
"0","pred_CH <- predict(model_CH, newdata = test_CH)"
"0","pred_CH"
"1","       1 "
"1","       2 "
"1","       3 "
"1","       4 "
"1","       5 "
"1","       6 "
"1","       7 "
"1","       8 "
"1","       9 "
"1","      10 "
"1","
"
"1","64.68383 "
"1","23.97183 "
"1","17.18649 "
"1","17.18649 "
"1","17.18649 "
"1","30.75716 "
"1","10.40116 "
"1","10.40116 "
"1","71.46916 "
"1","23.97183 "
"1","
"
"1","      11 "
"1","      12 "
"1","      13 "
"1","      14 "
"1","      15 "
"1","      16 "
"1","      17 "
"1","      18 "
"1","
"
"1","10.40116 "
"1","10.40116 "
"1","44.32783 "
"1","10.40116 "
"1","10.40116 "
"1","10.40116 "
"1","10.40116 "
"1","10.40116 "
"1","
"
"0","cor(test_CH$TsqrtMDs, pred_CH)"
"1","[1]"
"1"," 0.9531439"
"1","
"
"0","# r = 0.9531439 and predictions are shown in code"
"0",""
"0","#c)"
"0","shrinkage_CH <- summary(model_CH)$r.squared - (cor(test_CH$TsqrtMDs, pred_CH))^2"
"0","shrinkage_CH"
"1","[1]"
"1"," -0.0752451"
"1","
"
"0","# Shrinkage = -0.0752451. This value ^2 is very close to the R^2 value which tells us that the model works as well for any sample as it did for the training sample."
"0",""
"0","#9"
"0","#a)"
"0","train_GPA <- FirstYearGPA[1:150, ]"
"0","model_GPA <- lm(GPA ~ HSGPA + HU + White, data = train_GPA)"
"0","summary(model_GPA)"
"1","
Call:
"
"1",""
"1","lm(formula = GPA ~ HSGPA + HU + White, data = train_GPA)"
"1",""
"1","

"
"1",""
"1","Residuals:
"
"1","     Min "
"1","      1Q "
"1","  Median "
"1","      3Q "
"1","     Max "
"1","
"
"1","-1.09844 "
"1","-0.23079 "
"1"," 0.03517 "
"1"," 0.23600 "
"1"," 0.82933 "
"1","
"
"1","
Coefficients:
"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
(Intercept)"
"1"," 1.147478"
"1","   0.311524"
"1","   3.683"
"1"," 0.000323"
"1"," ***"
"1","
HSGPA      "
"1"," 0.466053"
"1","   0.088393"
"1","   5.273"
"1"," 4.75e-07"
"1"," ***"
"1","
HU         "
"1"," 0.015328"
"1","   0.004091"
"1","   3.747"
"1"," 0.000257"
"1"," ***"
"1","
White      "
"1"," 0.199174"
"1","   0.076152"
"1","   2.615"
"1"," 0.009846"
"1"," ** "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.3773"
"1"," "
"1","on"
"1"," "
"1","146"
"1"," "
"1","degrees of freedom"
"1","
"
"1","Multiple R-squared: "
"1"," "
"1","0.2842"
"1",",	Adjusted R-squared: "
"1"," "
"1","0.2695"
"1"," "
"1","
F-statistic:"
"1"," "
"1","19.32"
"1"," "
"1","on"
"1"," "
"1","3"
"1"," "
"1","and"
"1"," "
"1","146"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","1.319e-10"
"1","
"
"1","
"
"0","# The least squares regression line is given by GPA = 1.1475 + 0.46605(HSGPA) + 0.015328(HU) + 0.19917(White). All predictors are statistically significant since their p-values are below 0.05. The estimated standard deviation of the errors is 0.377, and the model explains 28.42% of the variation in GPA (R^2 = 0.2842)."
"0",""
"0","#b)"
"0","test_GPA <- FirstYearGPA[151:219, ]"
"0","pred_GPA <- predict(model_GPA, newdata = test_GPA)"
"0","pred_GPA"
"1","       1 "
"1","       2 "
"1","       3 "
"1","       4 "
"1","       5 "
"1","       6 "
"1","       7 "
"1","       8 "
"1","       9 "
"1","      10 "
"1","
"
"1","3.152561 "
"1","3.040603 "
"1","2.960027 "
"1","2.730315 "
"1","2.944078 "
"1","3.268243 "
"1","3.604737 "
"1","3.245045 "
"1","3.410132 "
"1","3.061938 "
"1","
"
"1","      11 "
"1","      12 "
"1","      13 "
"1","      14 "
"1","      15 "
"1","      16 "
"1","      17 "
"1","      18 "
"1","      19 "
"1","      20 "
"1","
"
"1","2.901408 "
"1","3.073537 "
"1","3.014712 "
"1","2.904827 "
"1","3.065147 "
"1","3.413655 "
"1","3.061895 "
"1","3.092490 "
"1","2.990063 "
"1","3.045884 "
"1","
"
"1","      21 "
"1","      22 "
"1","      23 "
"1","      24 "
"1","      25 "
"1","      26 "
"1","      27 "
"1","      28 "
"1","      29 "
"1","      30 "
"1","
"
"1","3.201649 "
"1","3.466889 "
"1","3.354205 "
"1","2.957334 "
"1","2.718183 "
"1","2.578471 "
"1","3.191812 "
"1","3.288337 "
"1","3.151835 "
"1","3.002475 "
"1","
"
"1","      31 "
"1","      32 "
"1","      33 "
"1","      34 "
"1","      35 "
"1","      36 "
"1","      37 "
"1","      38 "
"1","      39 "
"1","      40 "
"1","
"
"1","2.926162 "
"1","2.550298 "
"1","3.306568 "
"1","3.192433 "
"1","2.954020 "
"1","3.324895 "
"1","3.017908 "
"1","2.965929 "
"1","2.780842 "
"1","2.575170 "
"1","
"
"1","      41 "
"1","      42 "
"1","      43 "
"1","      44 "
"1","      45 "
"1","      46 "
"1","      47 "
"1","      48 "
"1","      49 "
"1","      50 "
"1","
"
"1","2.759209 "
"1","3.317013 "
"1","2.960027 "
"1","3.181870 "
"1","3.187047 "
"1","3.022686 "
"1","2.640300 "
"1","3.277669 "
"1","3.394287 "
"1","2.882145 "
"1","
"
"1","      51 "
"1","      52 "
"1","      53 "
"1","      54 "
"1","      55 "
"1","      56 "
"1","      57 "
"1","      58 "
"1","      59 "
"1","      60 "
"1","
"
"1","3.195629 "
"1","3.192223 "
"1","2.963844 "
"1","2.962720 "
"1","2.894557 "
"1","3.014607 "
"1","2.437825 "
"1","2.681637 "
"1","3.257576 "
"1","3.210957 "
"1","
"
"1","      61 "
"1","      62 "
"1","      63 "
"1","      64 "
"1","      65 "
"1","      66 "
"1","      67 "
"1","      68 "
"1","      69 "
"1","
"
"1","3.252399 "
"1","2.740256 "
"1","3.245771 "
"1","3.257060 "
"1","3.089176 "
"1","3.122512 "
"1","2.945009 "
"1","2.970695 "
"1","2.810164 "
"1","
"
"0","errors_GPA <- test_GPA$GPA - pred_GPA"
"0","errors_GPA"
"1","            1 "
"1","            2 "
"1","            3 "
"1","            4 "
"1","            5 "
"1","            6 "
"1","
"
"1"," 0.1774394377 "
"1"," 0.7093971450 "
"1"," 0.7199727824 "
"1","-0.5703145067 "
"1","-0.4140782175 "
"1","-0.0382432643 "
"1","
"
"1","            7 "
"1","            8 "
"1","            9 "
"1","           10 "
"1","           11 "
"1","           12 "
"1","
"
"1","-0.2047372186 "
"1","-0.6550454987 "
"1"," 0.3798684276 "
"1"," 0.4580618768 "
"1"," 0.1985923190 "
"1"," 0.2664629939 "
"1","
"
"1","           13 "
"1","           14 "
"1","           15 "
"1","           16 "
"1","           17 "
"1","           18 "
"1","
"
"1","-0.2747119553 "
"1"," 0.2351734504 "
"1","-0.7751471876 "
"1","-0.2536553431 "
"1","-0.0018953044 "
"1","-0.3524895565 "
"1","
"
"1","           19 "
"1","           20 "
"1","           21 "
"1","           22 "
"1","           23 "
"1","           24 "
"1","
"
"1","-0.3600627205 "
"1"," 0.0141157790 "
"1"," 0.7683507724 "
"1","-0.7868886116 "
"1"," 0.2257948302 "
"1"," 0.6026659164 "
"1","
"
"1","           25 "
"1","           26 "
"1","           27 "
"1","           28 "
"1","           29 "
"1","           30 "
"1","
"
"1","-0.0881825223 "
"1","-0.6084714179 "
"1"," 0.4681877699 "
"1"," 0.2216631324 "
"1","-0.0818348277 "
"1"," 0.1975249313 "
"1","
"
"1","           31 "
"1","           32 "
"1","           33 "
"1","           34 "
"1","           35 "
"1","           36 "
"1","
"
"1","-0.3461618179 "
"1","-0.6202984124 "
"1"," 0.2034320264 "
"1","-0.4424330626 "
"1"," 0.1059798830 "
"1","-0.4148954015 "
"1","
"
"1","           37 "
"1","           38 "
"1","           39 "
"1","           40 "
"1","           41 "
"1","           42 "
"1","
"
"1","-0.4579081385 "
"1","-0.3659294161 "
"1","-0.3708417600 "
"1","-0.0751703326 "
"1"," 0.1907910433 "
"1","-0.5770129223 "
"1","
"
"1","           43 "
"1","           44 "
"1","           45 "
"1","           46 "
"1","           47 "
"1","           48 "
"1","
"
"1","-0.1300272176 "
"1"," 0.0181296694 "
"1"," 0.4429532055 "
"1","-0.5626864554 "
"1"," 0.3596999810 "
"1"," 0.2423307665 "
"1","
"
"1","           49 "
"1","           50 "
"1","           51 "
"1","           52 "
"1","           53 "
"1","           54 "
"1","
"
"1","-0.2842874743 "
"1","-0.1221447143 "
"1"," 0.1743707542 "
"1","-0.6322232584 "
"1","-0.5838442333 "
"1"," 0.7272796483 "
"1","
"
"1","           55 "
"1","           56 "
"1","           57 "
"1","           58 "
"1","           59 "
"1","           60 "
"1","
"
"1","-0.7945570625 "
"1"," 0.1053929468 "
"1","-0.1978247748 "
"1","-0.4516368696 "
"1"," 0.4624243698 "
"1"," 0.4690425865 "
"1","
"
"1","           61 "
"1","           62 "
"1","           63 "
"1","           64 "
"1","           65 "
"1","           66 "
"1","
"
"1"," 0.4176008337 "
"1","-0.2202564063 "
"1"," 0.0842287668 "
"1"," 0.0529403002 "
"1"," 0.0408244100 "
"1","-0.2425121782 "
"1","
"
"1","           67 "
"1","           68 "
"1","           69 "
"1","
"
"1","-0.2950094662 "
"1","-0.0006948518 "
"1","-0.1901644095 "
"1","
"
"0","#c)"
"0","mean(errors_GPA)"
"1","[1]"
"1"," -0.05947226"
"1","
"
"0","sd(errors_GPA)"
"1","[1]"
"1"," 0.4065554"
"1","
"
"0","# The residuals have a mean of -0.0595, which is approximately zero, and a standard deviation of 0.4066, closely matching the model’s estimated error standard deviation of 0.377."
"0",""
"0","#d)"
"0","cor(test_GPA$GPA, pred_GPA)"
"1","[1]"
"1"," 0.5960115"
"1","
"
"0","# The r = 0.596"
"0",""
"0","#e)"
"0","shrinkage_GPA <- summary(model_GPA)$r.squared - (cor(test_GPA$GPA, pred_GPA))^2"
"0","shrinkage_GPA"
"1","[1]"
"1"," -0.07103228"
"1","
"
"0","# It works well since the shrinkage is negative"
"0",""
"0","#11"
"0","#a)"
"0","ReligionGDP$logGDP <- log(ReligionGDP$GDP)"
"0","plot(logGDP ~ Religiosity, data = ReligionGDP, xlab=""Religiosity"", ylab=""log(GDP)"")"
